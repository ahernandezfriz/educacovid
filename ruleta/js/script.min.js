$((function(){let ranking=[],intentos=0;const color=["#555E7B","#00b88f","#f84b25","#00376","#B576AD","#FDE47F","#7CCCE5","#005F6B","#f8b214","#D95B43","#DFBA69","#f65694","#596fb5","#E9E9E9","#E08E79","#E1F5C4","#351330","#E04644","#F27435","#BF4D28","#B7D968"];let num_segments;const containerPreguntas=$("#container-preguntas"),listadoPreguntas=$("#listado-preguntas"),containerResultados=$("#container-resultados"),btnResultados=$("#btn-resultados"),btnVolverJuego=$("#volver-juego"),btnGirarRuleta=$("#spin_button"),controles=$(".power_controls"),inputFile=$("#file-input"),inputGrup=$(".input_val"),btnSalirRuleta=$("#salir-ruleta"),btnExportar=$("#btnExportar"),contBtnGirar=$("#cont-btn-girar"),contBtnFinalizar=$("#cont-btn-finalizar"),containerGrupos=$("#container-grupos"),containerCrearGrupos=$("#container-crear-grupos");function setInicioDOM(){listadoPreguntas.hide(),containerResultados.hide(),containerGrupos.hide(),containerCrearGrupos.show(),$("#input_crear_grupo").val(2),containerPreguntas.show(),inputGrup.val(0),inputFile.val(""),inputFile.prop("disabled",!0),$("#ulListado-op").html(""),$("#ulListado").html(""),controles.show(),contBtnGirar.show(),contBtnFinalizar.show(),btnGirarRuleta.prop("disabled",!0),btnResultados.prop("disabled",!0)}function leerArchivo(e){var archivo=e.target.files[0];if(archivo){var lector=new FileReader;lector.onload=function(e){var contenido=e.target.result;if(contenido){intentos++;var lineas=contenido.split("\n");if(num_segments=lineas.length,num_segments<=15){var i=0;for(var linea of lineas)i++,$("#ulListado-op").append("<li class='disc disc_"+i+"'>"+i+"</li>"),$("#ulListado").append("<li class='preg pre_"+i+"'>"+linea+"</li>")}else $("#ulListado").append("<li>Hay m√°s de 10 pregutas e el archivo .txt</li>");addSegment(num_segments,intentos)}else listadoPreguntas.append("Archivo sin preguntas, vualva a subir un archivo .txt"),controles.show(),inputFile.prop("disabled",!1)},listadoPreguntas.show(),inputFile.prop("disabled",!0),btnGirarRuleta.prop("disabled",!1),btnResultados.prop("disabled",!1),controles.hide(),contBtnGirar.show(),contBtnFinalizar.show(),lector.readAsText(archivo)}}var fileInput;setInicioDOM(),$("#btn-crear-grupos").click((function(e){var $table_header,$table_body;e.preventDefault(),inputFile.prop("disabled",!1),containerGrupos.show(),containerCrearGrupos.hide(),$("#tabla-grupos").html(""),$nGrupos=$("#input_crear_grupo").val();for(var i=0;i<$nGrupos;i++){var pos=i+1;$table_header+="<td>G "+pos+"</td>",$table_body+="<td><input name='G"+pos+"' class='input_val' type='number' min='0' max='10' value='0' id='g"+pos+"' /></td>"}var $output_header="<tr>"+$table_header+"</tr>",$output_body="<tr>"+$table_body+"</tr>";$("#tabla-grupos").append($output_header+$output_body)})),btnResultados.click((function(e){e.preventDefault(),ranking=[],containerPreguntas.hide(),containerResultados.show(),containerGrupos.hide(),contBtnGirar.hide(),contBtnFinalizar.hide(),$(".input_val").each((function(){ranking.push({name:$(this).attr("name"),point:$(this).val()})})),ranking.sort((a,b)=>b.point-a.point);for(var i=0;i<ranking.length;i++){var pos=i+1;$(".table-ranking").append("<tr><td>"+pos+"</td><td>"+ranking[i].name+"</td><td>"+ranking[i].point+"</td></tr>")}})),document.getElementById("file-input").addEventListener("change",leerArchivo,!1);let theWheel=new Winwheel({outerRadius:115,innerRadius:8,textFontSize:18,textAlignment:"center",numSegments:0,segments:[{fillStyle:"#a186be",text:"1"},{fillStyle:"#fff200",text:"2"},{fillStyle:"#00ae44",text:"3"},{fillStyle:"#00aef0",text:"4"},{fillStyle:"#22aef0",text:"5"},{fillStyle:"#99aef0",text:"6"},{fillStyle:"#32aef0",text:"7"},{fillStyle:"#49aef0",text:"8"},{fillStyle:"#00ae22",text:"9"},{fillStyle:"#00ae12",text:"10"}],animation:{type:"spinToStop",duration:10,spins:3,callbackFinished:alertPrize,callbackSound:playSound,soundTrigger:"pin"},pins:{number:0,fillStyle:"silver",outerRadius:4}}),audio=new Audio("tick.mp3");function playSound(){audio.pause(),audio.currentTime=0,audio.play()}function addSegment(num_segments,intentos){if(intentos>1){for(var i=1;i<=num_segments;i++){const random=Math.floor(Math.random()*color.length);theWheel.addSegment({text:""+i,fillStyle:color[random]},1)}theWheel.deleteSegment(num_segments+1)}else for(var i=1;i<=num_segments;i++){const random=Math.floor(Math.random()*color.length);theWheel.addSegment({text:""+i,fillStyle:color[random]},1)}theWheel.draw()}function deleteSegment(){for(var i=20;i>=0;i--)theWheel.deleteSegment();theWheel.clearCanvas()}function resetRuleta(){theWheel.stopAnimation(!1),theWheel.rotationAngle=0,theWheel.draw(),wheelSpinning=!1}function alertPrize(indicatedSegment){$(".preg").removeClass("active"),$(".disc").removeClass("active-disc"),$(".pre_"+indicatedSegment.text).addClass("myClass active"),$(".disc_"+indicatedSegment.text).addClass("myClass2 active-disc");let segmentNumber=theWheel.getIndicatedSegmentNumber();theWheel.deleteSegment(segmentNumber),theWheel.clearCanvas(),resetRuleta();var si=0;$(".preg").each((function(index){$(this).hasClass("myClass")?(console.log("Si Existe myClass"),++si==num_segments&&btnGirarRuleta.prop("disabled",!0)):console.log("No existe myClass")}))}function salirRuleta(){location.href="../index.html"}function volverJuego(){$(".table-ranking tr").remove(),setInicioDOM(),deleteSegment()}function exportarRuleta(){$("#tabla-ranking").tableExport()}$("#spin_button").click((function(e){e.preventDefault(),resetRuleta(),theWheel.animation.spins=6,theWheel.startAnimation(),wheelSpinning=!1})),btnExportar.click(exportarRuleta),btnVolverJuego.click(volverJuego),btnSalirRuleta.click(salirRuleta)}));